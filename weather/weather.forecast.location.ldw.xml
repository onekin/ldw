<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
    <meta>
        <author>Christian Heilmann (author of the original ODT)</author>
        <author>Iker Azpeitia (author of this ODT++)</author>        
        <description>Weather with location</description>
        <documentationURL>http://developer.yahoo.com/weather/</documentationURL>
        <sampleQuery>URIPattern: weather.forecast.location.ldw/{location}</sampleQuery>
        <sampleQuery>URIexample: weather.forecast.location.ldw/donostia</sampleQuery>
         <sampleQuery>URIexample:  weather.forecast.location.ldw/bilbao</sampleQuery>
         <sampleQuery>URIexample:  weather.forecast.location.ldw/vitoria</sampleQuery>
        <sampleQuery>select * from {Table} where location ='donostia' | {Table}.lifting('http://rdf.onekin.org/weather/location/donostia')</sampleQuery>
    </meta>
    <bindings>
        <select produces="XML" itemPath="">
            <inputs>
                <key id="location" type="xs:string" paramType="query" required="true"/>
                <key id="unit" type="xs:string" paramType="query" default="c"/>
            </inputs>
            <execute><![CDATA[ 
          default xml namespace ='http://where.yahooapis.com/v1/schema.rng'; 
          var x = y.query('select woeid from geo.places(1) where text="'+location+'"');
          var s = x.results;
          var woeid = s..woeid;
          var weather = y.rest('http://weather.yahooapis.com/forecastrss?w='+woeid+'&u='+unit).get().response;
          response.object = <weather>{weather}</weather>;]]>
        </execute>
        </select>
        <function name="lifting">
<inputs>
<pipe id="oneReportXML" paramType="variable" />
<key id="URI" paramType="variable" required="true"/>
</inputs>
<execute> <![CDATA[
var oneJSON= y.xmlToJson(oneReportXML);
var oneJSON={'@context':{rdfs:'http://www.w3.org/2000/01/rdf-schema#',
geo:'http://www.w3.org/2003/01/geo/wgs84_pos#', 
wth:'http://www.scs.ryerson.ca/~bgajdero/msc_thesis/code/ontologies/weather-ont-t2.owl'}};
oneJSON['@id']= URI;
oneJSON['@type']='wth:WeatherReport';
oneJSON['geo:location']='http://www.dbpedia.org/resource/'+oneReportJSON.weather.rss.channel.location.city;
oneJSON['geo:lat']=oneReportJSON.weather.rss.channel.item.lat;
oneJSON['geo:long']=oneReportJSON.weather.rss.channel.item.long;
oneJSON['wth:hasReportTime']= oneReportJSON.weather.rss.channel.item.condition.date;
oneJSON['wth:windSpeed']= oneReportJSON.weather.rss.channel.wind.speed;
oneJSON['wth:windDirectionDegrees']= oneReportJSON.weather.rss.channel.wind.direction;
oneJSON['wth:humidityPercent']= oneReportJSON.weather.rss.channel.atmosphere.humidity;
oneJSON['wth:pressureMeasurement']= oneReportJSON.weather.rss.channel.atmosphere.pressure;
oneJSON['wth:visibilityDistance']= oneReportJSON.weather.rss.channel.atmosphere.visibility;
oneJSON['wth:celsiusTemperature']= oneReportJSON.weather.rss.channel.item.condition.temp;
response.object = oneJSON;]]>
</execute>
</function>
    </bindings>
</table>
