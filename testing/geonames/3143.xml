<?xml version="1.0" encoding="UTF-8"?>
      <table xmlns="http://query.yahooapis.com/v1/schema/table.xsd"
xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#">
    <meta>
        <author><!-- your name or company name --></author>
        <description><!-- description of the table --></description>
        <documentationURL><!-- url for API documentation --></documentationURL>
        <apiKeyURL><!-- url for getting an API key if needed --></apiKeyURL>
        <!--lowering-->
        <sampleQuery> URIPattern: http://rdf.onekin.org/geonames/feature/{geo:lat}/{geo:long}</sampleQuery>
        <sampleQuery> URIExample: http://rdf.onekin.org/geonames/feature/43.28/-2.16</sampleQuery>
    </meta>
    <bindings>
        <!--grounding-->
        <select itemPath="" produces="XML">
            <urls>
                <url>http://api.geonames.org/findNearbyPlaceName</url>
            </urls>
           <inputs>
                <key id="lat" as="geo:lat" type="xs:string" paramType="query" required="true" />
                <key id="lng" as="geo:long" type="xs:string" paramType="query" required="true" />
                <key id="username" type="xs:string" paramType="query" required="true" default="demo"/>
             </inputs>
        </select>
<!--lifting-->
      <function name="lifting">
       <inputs>
        <pipe id="oneXML" paramType="variable" />
        <key id="URI" paramType="variable"  required="true"/>
       </inputs> 
 	   <execute>  <![CDATA[
try{
 var oneJSON= y.xmlToJson(oneXML);
    var oneJSONLD={};

var variables = {}; 
variables['lat']=getValue("oneJSON['geonames']['geoname']['lat']");
variables['lng']=getValue("oneJSON['geonames']['geoname']['lng']");

	oneJSONLD['@id']=URI;
	oneJSONLD['@context']= {"gn":"http://www.geonames.org/ontology#","geo":"http://www.w3.org/2003/01/geo/wgs84_pos#","gn:locatedIn":{"@type":"@id"}};
	oneJSONLD['@type']= 'gn:Feature';    
    oneJSONLD['gn:countryCode']= getValue("oneJSON['geonames']['geoname']['countryCode']");
    oneJSONLD['gn:name']= getValue("oneJSON['geonames']['geoname']['name']");
    oneJSONLD['gn:locatedIn']= getInterlinkVars('http://rdf.onekin.org/geonames/feature/{lat}/{lng}', variables);
    oneJSONLD['km4c:hasWeatherReport']= getInterlinkVars('http://rdf.onekin.org/geonames/weather/{lat}/{lng}', variables);
    oneJSONLD['geo:lat']= getValue("oneJSON['geonames']['geoname']['lat']");
    oneJSONLD['geo:long']= getValue("oneJSON['geonames']['geoname']['lng']");
    
     }catch (err){ y.log(err);}
    response.object = oneJSONLD;

function getInterlinkVars (urlpattern, jsonVars){
 for(var i in jsonVars){
  try{urlpattern=urlpattern.replace('{'+i+'}', jsonVars[i]);}catch(err){}
 }
return urlpattern;
}

function getInterlink (urlpattern, value){
	try{return value? urlpattern.replace(/{.*}/, value) : null;}catch(err){return null;}}

function getRegexpValue(regexp, value){
 	try{return value.match(regexp)[0];}catch(err){return null;}}

function getValue(dataPath) {
	try{return eval(dataPath) || null; }catch(err){return null;}}

function getLength(obj) {
  	try{return obj? obj.length: 0; }catch(err){return 0;}}

]]>
        </execute> 
      </function> 
    </bindings> 
 </table>