<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
  <meta>
    <author>Jamie Matthews</author>
    <description>YQL table for Last.fm Event.getInfo API method. Get the metadata for an event on Last.fm. Includes attendance and lineup information.</description>
    <documentationURL>http://www.last.fm/api/show?service=292</documentationURL>
    <sampleQuery>URIPattern: lastfm/event/{event}</sampleQuery>
    <sampleQuery>URIexample: lastfm/event/3986264</sampleQuery>
    
  </meta>
  <bindings>
    <select itemPath="" produces="XML">
      <urls>
        <url>http://ws.audioscrobbler.com/2.0/?method=event.getinfo</url>
      </urls>
      <inputs>
        <key id="event" type="xs:string" paramType="query" required="true" />
        <key id="api_key" type="xs:string" paramType="query" required="true" />
        
      </inputs>
    </select>
    
            <function name="lifting">
           <inputs>
               <pipe id="oneEventXML" paramType="variable" />
               <key id="URI" paramType="variable"  required="true"/>
            </inputs>    
          <execute> <![CDATA[ 
var oneEventJSON=oneEventXML; 
var oneEventJSONLD['@context']= {rdfs:"http://www.w3.org/2000/01/rdf-schema#",
  		  schema:"http://schema.org/"};   
oneEventJSONLD['@id']= URI;
oneEventJSONLD['@type']='schema:Event';
oneEventJSONLD['schema:startDate']= oneEventJSON.lfm.event.startDate;
oneEventJSONLD['schema:description']= oneEventJSON.lfm.event.description;
oneEventJSONLD['schema:name']= oneEventJSON.lfm.event.title;
oneEventJSONLD['dbpedia:location']= 'http://www.dbpedia.org/resource/'+oneEventJSON.lfm.event.venue.location.city;
oneEventJSONLD['schema:performer']= 'http://rdf.onekin.org/musicbrainz/artist/'+oneEventJSON.lfm.event.artists.artist; 
//TODO: oneEventJSONLD['unknown:unknown']= oneEventJSON.lfm.event.cancelled;
//TODO: oneEventJSONLD['schema:location']= 'http://rdf.onekin.org/yelp/location/'+oneEventJSON.lfm.event.venue.location.city;
//TODO: oneEventJSONLD['@context']['dbpedia']="unknown";   
response.object = oneEventJSONLD;
;]]>
            </execute>
           </function>
  </bindings>
</table>
