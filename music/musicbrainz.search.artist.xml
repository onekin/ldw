<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
    <meta>
        <author>Maggie Pong</author>
        <description>MusicBrainz artist search</description>
        <documentationURL>http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2/Search</documentationURL>
        <sampleQuery>SELECT * FROM {table}</sampleQuery>
         <sampleQuery>URIPattern: http://rdf.onekin.org/musicbrainz.search.artist/artist/{@query} </sampleQuery>
        <sampleQuery>URIExample: http://rdf.onekin.org/musicbrainz.search.artist/artist/Madonna </sampleQuery>
    </meta>
    <bindings>
        <select itemPath="metadata.artist-list" produces="XML">
            <urls>
                <url>https://musicbrainz.org/ws/2/artist</url>
            </urls>
            <inputs>
                <key id="query" type="xs:string" paramType="query" required="true"/>
            </inputs>

            <paging model="offset">
                <start id="offset" default="0" />
                <pagesize id="limit" max="100" />
                <total default="25" />
            </paging>
        </select>
        <function name="artist"> <!--LIFTING -->
           <inputs>
               <pipe id="tuple" paramType="variable" />
               <key id="URI" paramType="variable"  type="foaf:Person"  xmlns:foaf="http://xmlns.com/foaf/0.1/" required="true"/>
            </inputs>    
          <execute> <![CDATA[ 
var jsontuple=y.xmlToJson(tuple);    
var ld={};
ld['@context']= {dbpedia: 'http://dbpedia.org/ontology/',
        foaf: 'http://xmlns.com/foaf/0.1/'};   
ld['@id']= URI;
ld['@type']='foaf:Person';
ld['foaf:name']= jsontuple["artist-list"].artist[0].name;
ld['dbpedia:nationality']= jsontuple["artist-list"].artist[0].area.name;
response.object = ld;
;]]>
            </execute>
           </function>
     </bindings>
</table>
