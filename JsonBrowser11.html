<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:widget="http://www.netvibes.com/ns/">
    <head>

        <!-- Application Metas -->
        <title>JSON-LD Browser - www.onekin.org</title>
        <meta name="author" content="www.onekin.org (Iker Azpeitia)" />
        <meta name="description" content="A JSON-LD Browser by www.onekin.org" />

        <!-- Application Standalone emulation files -->
        <link rel="stylesheet" type="text/css"
            href="http://uwa.netvibes.com/lib/c/UWA/assets/css/standalone.css" />
        <script type="text/javascript"
            src="http://uwa.netvibes.com/lib/c/UWA/js/UWA_Standalone_Alone.js"></script>

 <script type="text/javascript" src="https://cdn.rawgit.com/onekin/ldw/master/embeddedLD6.js"></script>
<script type="text/javascript">
 typeURIMap = {'video' : 'http://rdf.onekin.org/vimeo.video.ldw9/videoobject/[w .-]*'}
 tagType = 'span';
</script>
        <!-- Application Preferences -->
        <widget:preferences>
            			<widget:preference name="uri" type="text" label="Deref URI" defaultValue="http://rdf.onekin.org/vimeo.video.ldw11/videoobject/4964539"/>
        </widget:preferences>

        <!-- Application JavaScript Source -->
        <script type="text/javascript">
            var MyWidget = {
                onLoad: function() {
					uri = widget.getValue('uri');
                    MyWidget.urlCall(uri);
                },
				urlCall: function(url) {
                    widget.setValue('uri', url);
						UWA.Data.request(url, {
						         onComplete: MyWidget.onComplete,
						        onFailure: MyWidget.onFailure,
						       method: 'GET',
				        data: {   }  });
				},
				hashIt: function  (s) {
									var hash = 0, strlen = s.length, i, c;
									if (strlen === 0 ) {
									return hash;
									}
									for (i = 0; i < strlen; i++ ) {
									c = s.charCodeAt( i );
									hash += c;
									}
									return hash;
									},
                onComplete: function(json) {
                    var j = JSON.parse(json);
                    var name = j ['schema:name'];
                    var link = j ['schema:contentUrl'];
                    link = ' <a href="'+link+'">'+name+'</a> ';
                    var description = j ['schema:description'];
                    var desc= link + '<br/>'+description;
                    var interaction = j ['schema:interactionStatistic'];
                    var txt= "<br/>";
                    for (var k=0; k<interaction.length; k++){
                        var type = interaction[k]['schema:interactionType'];
                        var count = interaction[k]['schema:userInteractionCount'];    
                        txt = txt + type + " : " + count+"<br/>";
                    }
                    var url = j ['schema:thumbnailUrl'];
                    var html = '<img src="'+url+'" alt="'+url+'">'; 
                    widget.setBody(desc+txt+html);
                },
                onFailure: function(error) {
                    widget.setValue('uri', widget.getValue('defaulturi'));
                     MyWidget.body ('Problem retrieving data. Error:  ' + error);
                }
            }

            widget.addEvent('onLoad', MyWidget.onLoad);

        </script>
    </head>
		<body>
            .....
		</body>

</html>
