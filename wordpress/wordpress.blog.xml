<?xml version="1.0" encoding="UTF-8"?>
      <table xmlns="http://query.yahooapis.com/v1/schema/table.xsd"
	xmlns:dcterms="http://purl.org/dc/terms/"
     	xmlns:sioc="http://rdfs.org/sioc/ns#">
    <meta>
        <author>Iker Azpeitia</author>
        <description>LDW of WordPress blog containers</description>
        <documentationURL>https://developer.wordpress.org/rest-api/</documentationURL>
        <apiKeyURL>https://codex.wordpress.org/WordPress_APIs</apiKeyURL>
        <sampleQuery> URIPattern: http://rdf.onekin.org/wordpress/blog/{dcterms:identifier}/</sampleQuery>
        <sampleQuery> URIExample: http://rdf.onekin.org/wordpress/blog/ikeronekin/</sampleQuery>
    </meta>
    <bindings>
          <insert itemPath="" produces="XML">
            <inputs>
    <key id="blog" as="dcterms:identifier" type="xs:string" paramType="query" required="true" default="ikeronekin"/>
    <key id="username" type="xs:string" paramType="query" required="true" default="ikeronekin"/>
    <key id="password" type="xs:string" paramType="query" required="true" default="12OSin34"/>
    <key id="title" as="dcterms:title" type="xs:string" paramType="query" required="true" default="title"/>
    <key id="description" as="sioc:content" type="xs:string" paramType="query" required="true" default="description"/>
    <key id="tags" as="sioc:topic" type="xs:string" paramType="query"/>  
           </inputs>
            <execute><![CDATA[
y.log('1');
    var loweringinsert = "env 'store://datatables.org/alltableswithkeys'; insert into wordpress.post (title, description, blogurl, tags, username, password) values (@title, @description, @blogurl, @tags, @username, @password)";
    var loweringparams ={}; 
y.log('1');
loweringparams ['blogurl']= "https://"+inputs['dcterms:identifier']+".wordpress.com";
y.log('2');
loweringparams ['username']= inputs['username'];
y.log('3');
loweringparams ['password']= inputs['password'];
y.log('4');
loweringparams ['title']= inputs['dcterms:title'];
y.log('5');
loweringparams ['description']= inputs['sioc:content'];
y.log('6');
loweringparams ['tags']= inputs['sioc:topic'];
y.log('7'+loweringinsert);
var loweringquery = y.query (loweringinsert,loweringparams); 
y.log('8'+ loweringparams);
response.object =  loweringquery.results;
y.log('9');
 ]]>
            </execute>
      </insert>
 <function name="lifting">
  <inputs>
     <pipe id="oneXML" paramType="variable"/>
     <key id="URI" paramType="variable" required="true"/>
  </inputs>
 <execute><![CDATA[

try{
 var oneJSON= y.xmlToJson(oneXML);
	var oneJSONLD={};
	oneJSONLD['@id']=URI;
	oneJSONLD['@context']= {"sioc":"http://rdfs.org/sioc/ns#", "dcterms":"http://purl.org/dc/terms/"};
	oneJSONLD['@type']= 'sioc:Post';
oneJSONLD['dcterms:identifier'] = getValue("oneJSON['postid']");
    }catch (err){ y.log(err);}
    response.object = oneJSONLD;

function getInterlink (urlpattern, value){
	try{return value? urlpattern.replace(/{.*}/, value) : null;}catch(err){return null;}}

function getRegexpValue(regexp, value){
 	try{return value.match(regexp)[0];}catch(err){return null;}}

function getValue(dataPath) {
	try{return eval(dataPath) || null; }catch(err){return null;}}

function getLength(obj) {
  	try{return obj? obj.length: 0; }catch(err){return 0;}}

]]>
   </execute>
</function>
    </bindings> 
 </table>
